{% extends 'playlstr/base.html' %}
{% load static %}
{% block head %}
    <title>Import</title>
    <script src="{% static 'js/import.js' %}"></script>
    <script src="{% static 'js/spotify.js' %}" onload="loadSpotifyAccessToken()"></script>
{% endblock %}
{% block content %}
    <div id="importText" class="h1 centered vmargin-sm">
        Import Playlist
    </div>
    <br><br><br>
    <div id="spotifyImportContainer" class="centered">
        <div id="spotifyImport" class="input-group mb-3">
            <span class="input-group-text" id="spotifyImportText">
                Spotify
            </span>
            <input type="text" class="form-control" id="spotifyImportInput">
            <button type="button" class="btn btn-secondary btn-sm" onclick="importSpotifyUrl()">
                Import
            </button>
        </div>
        <div id="invalidSpotifyUrl" class="alert alert-danger hidden">Invalid URL</div>
        <div id="spotifyImportRequestSent" class="centered hidden">
            <div id="spotifyImportSpinner" class="spinner-border">
            </div>
            Importing...
        </div>
        <div id="spotifyImportFailed" class="alert alert-danger hidden">
            Failed to import playlist
        </div>
    </div>
    <script>
        loc = window.location.toString();
        start = loc.indexOf("state=") + 6;
        if (start !== 5) {
            end = loc.indexOf("&", start);
            if (end === -1) {
                end = loc.indexOf("?", start);
                if (end === -1) {
                    end = loc.length;
                }
            }
            url = decodeURIComponent(loc.substring(start, end));
            document.getElementById('spotifyImportInput').value = url;
        }
    </script>
{% endblock %}
